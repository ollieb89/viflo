---
phase: 08-verification-closure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .agent/skills/microservices-patterns/SKILL.md
  - .agent/skills/microservices-patterns/references/guides/best-practices.md
autonomous: true
requirements:
  - CONTENT-01

must_haves:
  truths:
    - "microservices-patterns/SKILL.md is ≤500 lines"
    - "Best Practices and Common Pitfalls content is accessible via a reference guide"
    - "SKILL.md links to the new reference guide"
  artifacts:
    - path: ".agent/skills/microservices-patterns/SKILL.md"
      provides: "Core microservices patterns reference"
      max_lines: 500
    - path: ".agent/skills/microservices-patterns/references/guides/best-practices.md"
      provides: "Best practices and common pitfalls for microservices"
      min_lines: 40
  key_links:
    - from: ".agent/skills/microservices-patterns/SKILL.md"
      to: ".agent/skills/microservices-patterns/references/guides/best-practices.md"
      via: "markdown link in ## Best Practices section"
      pattern: "\\[.*\\]\\(references/guides/best-practices\\.md\\)"
---

<objective>
Trim `microservices-patterns/SKILL.md` from 540 lines to ≤500 lines by extracting the "Best Practices" and "Common Pitfalls" sections into a new reference guide, then linking back from SKILL.md.

Purpose: Closes the single remaining CONTENT-01 gap identified in the v1.1 milestone audit. The audit confirmed 11 of 12 modularized skills are ≤500 lines; this fix completes the requirement.
Output: SKILL.md at ≤500 lines; new `references/guides/best-practices.md` with full content; SKILL.md updated to reference the guide.
</objective>

<execution_context>
@/home/ollie/.claude/get-shit-done/workflows/execute-plan.md
@/home/ollie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/v1.1-MILESTONE-AUDIT.md
@.agent/skills/microservices-patterns/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract Best Practices and Common Pitfalls to reference guide</name>
  <files>.agent/skills/microservices-patterns/references/guides/best-practices.md</files>
  <action>
    Create `.agent/skills/microservices-patterns/references/guides/best-practices.md` containing the full "Best Practices" and "Common Pitfalls" sections extracted verbatim from SKILL.md (lines 521–540, approximately 40 lines of content).

    The file must start with a header and a back-link:

    ```markdown
    # Microservices Patterns — Best Practices & Common Pitfalls

    > Part of [microservices-patterns](../SKILL.md) skill.

    ## Best Practices

    1. **Service Boundaries**: Align with business capabilities
    2. **Database Per Service**: No shared databases
    3. **API Contracts**: Versioned, backward compatible
    4. **Async When Possible**: Events over direct calls
    5. **Circuit Breakers**: Fail fast on service failures
    6. **Distributed Tracing**: Track requests across services
    7. **Service Registry**: Dynamic service discovery
    8. **Health Checks**: Liveness and readiness probes

    ## Common Pitfalls

    - **Distributed Monolith**: Tightly coupled services
    - **Chatty Services**: Too many inter-service calls
    - **Shared Databases**: Tight coupling through data
    - **No Circuit Breakers**: Cascade failures
    - **Synchronous Everything**: Tight coupling, poor resilience
    - **Premature Microservices**: Starting with microservices
    - **Ignoring Network Failures**: Assuming reliable network
    - **No Compensation Logic**: Can't undo failed transactions
    ```

    Write this content exactly (preserve the numbered list and bullet format).
  </action>
  <verify>
    <automated>wc -l /home/ollie/Development/Tools/viflo/.agent/skills/microservices-patterns/references/guides/best-practices.md</automated>
    <manual>File should have ≥25 lines and contain both "Best Practices" and "Common Pitfalls" headings.</manual>
  </verify>
  <done>best-practices.md exists with both sections and the back-link to SKILL.md.</done>
</task>

<task type="auto">
  <name>Task 2: Trim SKILL.md to ≤500 lines with link to reference guide</name>
  <files>.agent/skills/microservices-patterns/SKILL.md</files>
  <action>
    Edit `.agent/skills/microservices-patterns/SKILL.md` to replace the inline "Best Practices" and "Common Pitfalls" sections (lines ~521–540) with a compact summary that links to the new reference guide.

    Replace the two sections with:

    ```markdown
    ## Best Practices & Common Pitfalls

    See [Best Practices & Common Pitfalls Guide](references/guides/best-practices.md) for the full list of production guidelines and anti-patterns to avoid.
    ```

    This removes ~17 lines and brings the file from 540 to approximately 524 lines. To reach ≤500, also replace the verbose "Resources" section (lines ~510–518) with a condensed version:

    ```markdown
    ## Extended References

    - [Circuit Breaker Implementation](references/guides/circuit-breaker.md)
    - [Service Discovery Guide](references/guides/service-discovery.md)
    - [Best Practices & Common Pitfalls](references/guides/best-practices.md)
    ```

    After both edits, confirm line count is ≤500 with `wc -l`. If still over, identify and trim any trailing blank lines or redundant blank lines between code blocks (do NOT remove code examples or conceptual content).
  </action>
  <verify>
    <automated>wc -l /home/ollie/Development/Tools/viflo/.agent/skills/microservices-patterns/SKILL.md</automated>
    <manual>Line count must be ≤500. Verify SKILL.md still contains all core sections: Core Concepts, Service Decomposition Patterns, Communication Patterns, Resilience Patterns, Service Discovery. Verify link to best-practices.md is present.</manual>
  </verify>
  <done>SKILL.md line count is ≤500 and contains a working link to references/guides/best-practices.md.</done>
</task>

</tasks>

<verification>
```bash
# Verify SKILL.md is ≤500 lines
wc -l .agent/skills/microservices-patterns/SKILL.md

# Verify best-practices.md exists with content
wc -l .agent/skills/microservices-patterns/references/guides/best-practices.md

# Verify link is present in SKILL.md
grep "best-practices.md" .agent/skills/microservices-patterns/SKILL.md

# Verify all existing reference guide links still valid
grep -n "references/guides/" .agent/skills/microservices-patterns/SKILL.md
```
</verification>

<success_criteria>
- `microservices-patterns/SKILL.md` is ≤500 lines
- `references/guides/best-practices.md` exists with ≥25 lines containing Best Practices and Common Pitfalls
- SKILL.md links to best-practices.md via `[...](references/guides/best-practices.md)`
- All other existing reference links (circuit-breaker.md, service-discovery.md) remain intact
- CONTENT-01 requirement is fully satisfied: all 12 modularized skills now ≤500 lines
</success_criteria>

<output>
After completion, create `.planning/phases/08-verification-closure/08-01-SUMMARY.md` documenting:
- Final line count of SKILL.md
- Content moved to best-practices.md
- Verification command output confirming ≤500 lines
- CONTENT-01 requirement closure confirmation
</output>
