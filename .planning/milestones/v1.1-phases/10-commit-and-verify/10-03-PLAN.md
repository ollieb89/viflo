---
phase: 10-commit-and-verify
plan: "03"
type: execute
wave: 2
depends_on:
  - "10-01"
  - "10-02"
files_modified:
  - .planning/phases/09-workspace-tooling/09-VERIFICATION.md
  - .planning/REQUIREMENTS.md
  - .planning/ROADMAP.md
autonomous: true
gap_closure: true
requirements:
  - CI-02
  - QUAL-01
  - QUAL-02
  - QUAL-04
  - CONTENT-01
  - CONTENT-02
  - CONTENT-03

must_haves:
  truths:
    - "09-VERIFICATION.md exists and verifies all 4 Phase 9 success criteria against the committed tree"
    - "All 7 previously-unchecked requirements (CI-02, QUAL-01, QUAL-02, QUAL-04, CONTENT-01, CONTENT-02, CONTENT-03) are marked [x] in REQUIREMENTS.md"
    - "ROADMAP.md Phase 9 and Phase 10 are marked complete with checkmarks"
    - "git ls-files confirms every artifact is tracked (no untracked Phase 7 or 9 files)"
  artifacts:
    - path: ".planning/phases/09-workspace-tooling/09-VERIFICATION.md"
      provides: "Phase 9 verification record"
      contains: "pnpm-workspace.yaml"
    - path: ".planning/REQUIREMENTS.md"
      provides: "All 11 requirements marked [x]"
    - path: ".planning/ROADMAP.md"
      provides: "Phase 9 and 10 marked complete"
  key_links:
    - from: ".planning/phases/09-workspace-tooling/09-VERIFICATION.md"
      to: "committed tree"
      via: "git ls-files checks in VERIFICATION.md"
      pattern: "git ls-files pnpm-workspace.yaml"
    - from: ".planning/REQUIREMENTS.md"
      to: "CI-02, QUAL-01, QUAL-02, QUAL-04, CONTENT-01, CONTENT-02, CONTENT-03"
      via: "checkbox status"
      pattern: "\\[x\\] \\*\\*CI-02\\*\\*"
---

<objective>
Create Phase 9 VERIFICATION.md, check off all 7 remaining requirements in REQUIREMENTS.md, and update ROADMAP.md to reflect completion of Phases 9 and 10.

Purpose: Plans 01 and 02 committed all disk artifacts to HEAD. This plan verifies the committed tree satisfies Phase 9's 4 success criteria, marks all requirements satisfied, and closes the Phase 10 gap-closure work in the roadmap.

Output: 09-VERIFICATION.md (phase verification record), updated REQUIREMENTS.md (all 11 requirements checked), updated ROADMAP.md (Phases 9 and 10 complete), committed to git.
</objective>

<execution_context>
@/home/ollie/.claude/get-shit-done/workflows/execute-plan.md
@/home/ollie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@.planning/10-commit-and-verify/10-01-SUMMARY.md
@.planning/10-commit-and-verify/10-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify committed tree satisfies all Phase 9 success criteria</name>
  <files>none (read-only verification against committed HEAD)</files>
  <action>
    Run these checks against the committed tree (HEAD, not working tree) to confirm each Phase 9 success criterion is met. Record the result of each check — these results will populate the VERIFICATION.md in Task 2.

    Criterion 1: pnpm-workspace.yaml declares apps/* and packages/*
    ```bash
    git show HEAD:pnpm-workspace.yaml
    ```
    PASS condition: Output contains `- 'apps/*'` and `- 'packages/*'` (or equivalent syntax).

    Criterion 2: CI pipeline uses single pnpm install (no cd apps/web workaround)
    ```bash
    git show HEAD:.github/workflows/ci.yml | grep -E "(cd apps|pnpm install)"
    ```
    PASS condition: Shows `pnpm install --frozen-lockfile` without any preceding `cd apps/web` line for the same install step. The workaround line must be absent.

    Criterion 3: pre-commit install automated via setup script
    ```bash
    git show HEAD:scripts/setup-dev.sh | grep "pre-commit install"
    ```
    PASS condition: Output contains `pre-commit install`.

    Criterion 4: README.md or CONTRIBUTING.md references onboarding command
    ```bash
    git show HEAD:CONTRIBUTING.md | grep -E "(setup-dev|./scripts/setup)"
    ```
    PASS condition: At least one matching line found.

    Bonus check — git ls-files confirms all Phase 7 artifacts committed:
    ```bash
    git ls-files .agent/skills/api-design-principles/SKILL.md .planning/verifications/phase-0-VERIFICATION.md scripts/log-telemetry.sh .telemetry/usage.csv
    ```
    PASS condition: All 4 paths returned.

    If any criterion FAILS, stop and report which criterion failed and why — do NOT create VERIFICATION.md with incorrect results.
  </action>
  <verify>
    <automated>git -C /home/ollie/Development/Tools/viflo show HEAD:pnpm-workspace.yaml | grep -c "apps" && git -C /home/ollie/Development/Tools/viflo show HEAD:scripts/setup-dev.sh | grep -c "pre-commit install" && git -C /home/ollie/Development/Tools/viflo show HEAD:CONTRIBUTING.md | grep -c "setup-dev"</automated>
    <manual>All three commands should return 1 or greater. If any returns 0, a criterion fails — stop before creating VERIFICATION.md.</manual>
  </verify>
  <done>All 4 Phase 9 success criteria verified against committed HEAD. Bonus check confirms Phase 7 artifacts committed. Ready to write VERIFICATION.md.</done>
</task>

<task type="auto">
  <name>Task 2: Create Phase 9 VERIFICATION.md and finalize requirements + roadmap</name>
  <files>
    .planning/phases/09-workspace-tooling/09-VERIFICATION.md
    .planning/REQUIREMENTS.md
    .planning/ROADMAP.md
  </files>
  <action>
    **Step A: Create .planning/phases/09-workspace-tooling/09-VERIFICATION.md**

    Write the file with the following structure (fill in actual commit SHAs from Task 1 results and Plans 01+02 SUMMARYs):

    ```markdown
    ---
    phase: 09-workspace-tooling
    verified: 2026-02-24
    status: passed
    requirements: [CI-02, QUAL-01, QUAL-02, QUAL-04]
    ---

    # Phase 9: Workspace & Developer Tooling — Verification

    **Verified against committed HEAD** (not disk state)
    **Date:** 2026-02-24

    ## Success Criteria Verification

    ### Criterion 1: pnpm-workspace.yaml declares apps/* and packages/*

    - [x] `git ls-files pnpm-workspace.yaml` returns `pnpm-workspace.yaml`
    - [x] `git show HEAD:pnpm-workspace.yaml` contains `apps/*` and `packages/*`

    **Evidence:** `pnpm-workspace.yaml` committed in Phase 10 Plan 02 commit.

    ### Criterion 2: CI pipeline uses single pnpm install (no workaround)

    - [x] `git show HEAD:.github/workflows/ci.yml | grep "cd apps/web"` returns no output
    - [x] Single `pnpm install --frozen-lockfile` step at root level present

    **Evidence:** Updated ci.yml committed in Phase 10 Plan 02 commit. Workaround `cd apps/web && pnpm install` removed.

    ### Criterion 3: pre-commit install automated via setup script

    - [x] `git ls-files scripts/setup-dev.sh` returns `scripts/setup-dev.sh`
    - [x] `git show HEAD:scripts/setup-dev.sh | grep "pre-commit install"` returns matching line

    **Evidence:** `scripts/setup-dev.sh` committed in Phase 10 Plan 02 commit.

    ### Criterion 4: README.md or CONTRIBUTING.md references onboarding command

    - [x] `git show HEAD:CONTRIBUTING.md | grep "setup-dev"` returns reference to `./scripts/setup-dev.sh`

    **Evidence:** CONTRIBUTING.md updated with Quick Setup section committed in Phase 10 Plan 02 commit.

    ## Integration Verification

    ### Flow: Fresh clone CI pipeline

    - [x] `pnpm-workspace.yaml` committed — `pnpm --filter @viflo/web test` can resolve workspace
    - [x] ci.yml `pnpm install --frozen-lockfile` at root installs all workspace packages
    - [x] CI `pnpm run test` → `pnpm --filter @viflo/web test` will succeed on fresh clone

    ### Flow: Pre-commit hook installation

    - [x] `scripts/setup-dev.sh` runs `pre-commit install` automatically
    - [x] CONTRIBUTING.md documents `./scripts/setup-dev.sh` as the setup command

    ## Requirements Closed

    | Requirement | Evidence |
    |-------------|----------|
    | CI-02 | pnpm-workspace.yaml + updated ci.yml committed |
    | QUAL-01 | setup-dev.sh automates pre-commit install |
    | QUAL-02 | Follows from QUAL-01: hooks installed = secrets blocked |
    | QUAL-04 | pnpm-workspace.yaml enables CI filter to resolve @viflo/web |

    **Verdict: PASSED** — All 4 Phase 9 success criteria satisfied in committed tree.
    ```

    **Step B: Update REQUIREMENTS.md — check off 7 requirements**

    Read the current REQUIREMENTS.md and change the following lines from `[ ]` to `[x]`:
    - `[ ] **CI-02**` → `[x] **CI-02**`
    - `[ ] **QUAL-01**` → `[x] **QUAL-01**`
    - `[ ] **QUAL-02**` → `[x] **QUAL-02**`
    - `[ ] **QUAL-04**` → `[x] **QUAL-04**`
    - `[ ] **CONTENT-01**` → `[x] **CONTENT-01**`
    - `[ ] **CONTENT-02**` → `[x] **CONTENT-02**`
    - `[ ] **CONTENT-03**` → `[x] **CONTENT-03**`

    After this change all 11 v1.1 requirements should be `[x]`.

    Also update the traceability table — change `Pending` to `Complete` for CI-02, QUAL-01, QUAL-02, QUAL-04, CONTENT-01, CONTENT-02, CONTENT-03.

    Update the footer: `_Last updated: 2026-02-24 — All 11 v1.1 requirements satisfied (Phase 10 gap closure complete)_`

    **Step C: Update ROADMAP.md — mark Phase 9 and Phase 10 complete**

    Read the current ROADMAP.md and make these changes:

    1. In the phase list under `### ✅ v1.1 Dogfooding (Complete)`:
       - Change `- [ ] **Phase 9: Workspace & Developer Tooling**` → `- [x] **Phase 9: Workspace & Developer Tooling** ✅`
       - Change `- [ ] **Phase 10: Commit and Verify Uncommitted Work**` → `- [x] **Phase 10: Commit and Verify Uncommitted Work** ✅`

    2. In the progress table, update Phase 9 row:
       - Change `| 9. Workspace Tooling | v1.1 | TBD | Pending | |` to `| 9. Workspace Tooling | v1.1 | 2/2 | Complete | 2026-02-24 |`
       - Change `| 10. Commit & Verify | v1.1 | 0/1 | Pending | |` to `| 10. Commit & Verify | v1.1 | 3/3 | Complete | 2026-02-24 |`

    3. In the Phase 10 detail section, update the plan list:
       - Change `- [ ] 10-01-PLAN.md` → `- [x] 10-01-PLAN.md — Commit Phase 7 artifacts (CONTENT-01, CONTENT-02, CONTENT-03) ✅`
       - Change `- [ ] 10-02-PLAN.md` (if missing, add) → `- [x] 10-02-PLAN.md — Commit Phase 9 artifacts (CI-02, QUAL-01, QUAL-02, QUAL-04) ✅`
       - Add `- [x] 10-03-PLAN.md — Create Phase 9 VERIFICATION.md and finalize requirements ✅`

    **Step D: Update STATE.md**

    Read the current STATE.md and update:
    - Change `**Phase**: 9 of 9` to `**Phase**: 10 of 10 — Commit & Verify ✅ COMPLETE`
    - Add to Completed section: `## Completed (Phase 10)`
      ```
      - [x] 10-01-PLAN.md — Committed Phase 7 artifacts (CONTENT-01, CONTENT-02, CONTENT-03)
      - [x] 10-02-PLAN.md — Committed Phase 9 artifacts (CI-02, QUAL-01, QUAL-02, QUAL-04)
      - [x] 10-03-PLAN.md — Created Phase 9 VERIFICATION.md, closed all 11 requirements
      ```

    **Step E: Commit all changes**

    ```bash
    cd /home/ollie/Development/Tools/viflo
    git add .planning/phases/09-workspace-tooling/09-VERIFICATION.md
    git add .planning/REQUIREMENTS.md
    git add .planning/ROADMAP.md
    git add .planning/STATE.md
    git commit -m "$(cat <<'EOF'
docs(phase-10): create Phase 9 VERIFICATION.md, close all 11 v1.1 requirements

- .planning/phases/09-workspace-tooling/09-VERIFICATION.md: verifies all 4
  Phase 9 success criteria against committed tree — status PASSED
- REQUIREMENTS.md: all 11 v1.1 requirements now [x] (CI-02, QUAL-01, QUAL-02,
  QUAL-04, CONTENT-01, CONTENT-02, CONTENT-03 closed by Phase 10 commits)
- ROADMAP.md: Phase 9 and Phase 10 marked complete
- STATE.md: v1.1 Dogfooding milestone fully complete

Co-Authored-By: Claude Sonnet 4.6 <noreply@anthropic.com>
EOF
)"
    ```
  </action>
  <verify>
    <automated>git -C /home/ollie/Development/Tools/viflo ls-files .planning/phases/09-workspace-tooling/09-VERIFICATION.md && grep -c "\[x\] \*\*CI-02\*\*" /home/ollie/Development/Tools/viflo/.planning/REQUIREMENTS.md && grep -c "\[x\] \*\*CONTENT-03\*\*" /home/ollie/Development/Tools/viflo/.planning/REQUIREMENTS.md</automated>
    <manual>Confirm 09-VERIFICATION.md is tracked in git, and both CI-02 and CONTENT-03 are checked [x] in REQUIREMENTS.md (verifying first and last of the 7 requirements)</manual>
  </verify>
  <done>
    09-VERIFICATION.md exists in .planning/phases/09-workspace-tooling/ and is committed to HEAD.
    REQUIREMENTS.md has all 11 v1.1 requirements marked [x].
    ROADMAP.md shows Phase 9 and Phase 10 as complete.
    STATE.md reflects v1.1 Dogfooding milestone complete.
    `git status` shows a clean working tree (no untracked Phase 7 or 9 artifacts).
  </done>
</task>

</tasks>

<verification>
Final state verification after all 3 plans complete:

```bash
# All 11 requirements checked
grep -c "\[x\]" .planning/REQUIREMENTS.md
# Should return 11 (for v1.1 requirements section)

# Phase 9 VERIFICATION.md committed
git ls-files .planning/phases/09-workspace-tooling/09-VERIFICATION.md
# Should return the path

# No untracked Phase 7 or Phase 9 artifacts remain
git status --short | grep -E "(\?\?|M ).*(SKILL\.md|telemetry|setup-dev|pnpm-workspace)"
# Should return nothing (all committed)

# Fresh clone simulation: workspace topology committed
git show HEAD:pnpm-workspace.yaml | grep "apps"
# Should return: - 'apps/*'
```
</verification>

<success_criteria>
- 09-VERIFICATION.md exists and is committed, status: passed, all 4 success criteria verified
- All 11 v1.1 requirements are [x] in REQUIREMENTS.md
- ROADMAP.md shows Phase 9 (2/2 complete) and Phase 10 (3/3 complete)
- `git status` is clean — no untracked Phase 7 or 9 artifacts
- v1.1 Dogfooding milestone is fully closed in committed tree
</success_criteria>

<output>
After completion, create `.planning/10-commit-and-verify/10-03-SUMMARY.md` documenting:
- What was created and updated
- The commit SHA
- Final requirements count (11/11)
- Confirmation that v1.1 milestone is complete
</output>
